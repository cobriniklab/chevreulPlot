<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Visualization • chevreulPlot</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Visualization">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">chevreulPlot</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/chevreulPlot.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/visualization.html">Visualization</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/cobriniklab/chevreulPlot/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Visualization</h1>
                        <h4 data-toc-skip class="author">Kevin
Stachelek</h4>
            <address class="author_afil">
      University of Southern
California<br><a class="author_email" href="mailto:#"></a><a href="mailto:kevin.stachelek@gmail.com" class="email">kevin.stachelek@gmail.com</a>
      </address>
                              <h4 data-toc-skip class="author">Bhavana
Bhat</h4>
            <address class="author_afil">
      University of Southern
California<br><a class="author_email" href="mailto:#"></a><a href="mailto:bbhat@usc.edu" class="email">bbhat@usc.edu</a>
      </address>
                  
            <h4 data-toc-skip class="date">31 October 2024</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/cobriniklab/chevreulPlot/blob/master/vignettes/visualization.Rmd" class="external-link"><code>vignettes/visualization.Rmd</code></a></small>
      <div class="d-none name"><code>visualization.Rmd</code></div>
    </div>

    
    
<p>This article demonstrates the data visualization tools in
chevreulPlot. We’ll introduce included functions, their usage, and
resulting plots</p>
<p>First step is to load chevreulPlot package and all other packages
required</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/cobriniklab/chevreulPlot" class="external-link">chevreulPlot</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://bioconductor.org/packages/scater/" class="external-link">scater</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MarioniLab/scran/" class="external-link">scran</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lazappi/clustree" class="external-link">clustree</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/whtns/chevreuldata" class="external-link">chevreuldata</a></span><span class="op">)</span></span>
<span><span class="va">chevreul_sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/chevreuldata/man/human_gene_transcript_sce.html" class="external-link">human_gene_transcript_sce</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>The different plotting functions within chevreulPlot allows for
visualization of data, these plots can be customized for interactive or
non-interactive display.</p>
<div class="section level2">
<h2 id="plot-expression">Plot expression<a class="anchor" aria-label="anchor" href="#plot-expression"></a>
</h2>
<p>Expression of a feature (genes or transcripts) can be plotted on a
given embedding resulting in an interactive feature plot.</p>
<p>When plotting only one feature, output is identical to
<code>SingleCellExperiment::FeaturePlot</code></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_feature_on_embedding.html">plot_feature_on_embedding</a></span><span class="op">(</span><span class="va">chevreul_sce</span>,</span>
<span>    embedding <span class="op">=</span> <span class="st">"UMAP"</span>,</span>
<span>    features <span class="op">=</span> <span class="st">"NRL"</span>, return_plotly <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/unnamed-chunk-1-1.png" width="100%"></p>
<p>An interactive output plot can be generated by specifying
<code>return_plotly = TRUE</code> which uses <code>ggplotly</code>
allowing identification of individual cells for further
investigation.</p>
<div class="section level3">
<h3 id="plot-read-count-or-other-qc-measurements">Plot read count or other QC measurements<a class="anchor" aria-label="anchor" href="#plot-read-count-or-other-qc-measurements"></a>
</h3>
<p>The <code>plot_colData_histogram</code> function displays a histogram
of cell read counts colored according to a categorical variable using
the argument <code>fill_by</code>. Here we can see that read counts for
this dataset are not distinctly different depending on the method of
organoid preparation used (Kuwahara or Zhong)</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_colData_histogram.html">plot_colData_histogram</a></span><span class="op">(</span><span class="va">chevreul_sce</span>,</span>
<span>    group_by <span class="op">=</span> <span class="st">"nCount_RNA"</span>,</span>
<span>    fill_by <span class="op">=</span> <span class="st">"Prep.Method"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/unnamed-chunk-2-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="plot-metadata-variable">Plot metadata variable<a class="anchor" aria-label="anchor" href="#plot-metadata-variable"></a>
</h3>
<p>Make an interactive scatter plot of a metadata variable, where each
point in the plot represents a cell whose position on the plot is given
by the cell embedding determined by the dimensional reduction technique
by default, “UMAP”. The group argument specifies the colData variable by
which to group the cells by, by default, “batch”.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_colData_on_embedding.html">plot_colData_on_embedding</a></span><span class="op">(</span><span class="va">chevreul_sce</span>,</span>
<span>    group <span class="op">=</span> <span class="st">"gene_snn_res.0.2"</span>,</span>
<span>    embedding <span class="op">=</span> <span class="st">"UMAP"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/unnamed-chunk-3-1.png" width="100%"></p>
<p>This function utilizes a SingleCellExperiment function,
<code>DimPlot()</code>, as sub function which produces the dimensional
reduction plot. The interactive parameter, <code>return_plotly</code>,
in plot_colData_on_embedding when set to TRUE will convert the plot into
an interactive plot using ggplotly function from R’s plotly package</p>
</div>
<div class="section level3">
<h3 id="plot-cluster-marker-genes">Plot cluster marker genes<a class="anchor" aria-label="anchor" href="#plot-cluster-marker-genes"></a>
</h3>
<p>Marker genes of louvain clusters or additional experimental metadata
can be plotted using <code>plot_marker_features</code>. This allows
visualization of n marker features grouped by the metadata of interest.
Marker genes are identified using wilcoxon rank-sum test as implemented
in <code>presto</code>. In the resulting dot plot the size of the dot
corresponds to the percentage of cells expressing the feature in each
cluster and the color represents the average expression level of the
feature.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_marker_features.html">plot_marker_features</a></span><span class="op">(</span><span class="va">chevreul_sce</span>,</span>
<span>    group_by <span class="op">=</span> <span class="st">"gene_snn_res.0.2"</span>,</span>
<span>    marker_method <span class="op">=</span> <span class="st">"wilcox"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/unnamed-chunk-4-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="plotting-transcript-composition">Plotting transcript composition<a class="anchor" aria-label="anchor" href="#plotting-transcript-composition"></a>
</h3>
<p><code><a href="../reference/plot_transcript_composition.html">plot_transcript_composition()</a></code> plots the proportion of
reads of a given gene map to each transcript. The gene of interest is
specified by the argument ‘gene_symbol’.</p>
<p><img src="visualization_files/figure-html/unnamed-chunk-5-1.png" width="100%"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kevin Stachelek, Bhavana Bhat.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
